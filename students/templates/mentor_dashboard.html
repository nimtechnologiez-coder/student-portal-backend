{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mentor Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
  background: linear-gradient(135deg, #e0f7fa, #ffffff);
  min-height: 100vh;
  font-family: "Poppins", sans-serif;
}

/* MAIN BOX */
.container-box {
  width: 95%;
  max-width: 1100px;
  margin: 50px auto;
  background: #fff;
  border-radius: 16px;
  padding: 30px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.1);
  border: 1px solid rgba(0,150,136,0.2);
}

/* HEADER */
.page-title {
  color: #00796b;
  font-weight: 700;
  text-align: center;
  margin-bottom: 25px;
}

/* ADD BUTTON */
.btn-add {
  background: linear-gradient(90deg, #009688, #26a69a);
  color: #fff !important;
  padding: 10px 18px;
  border-radius: 10px;
  border: none;
  font-weight: 600;
  text-decoration: none !important;
}
.btn-add:hover { opacity: 0.9; }

/* TABLE BOX */
.table-box {
  background: #ffffff;
  padding: 15px;
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  border: 1px solid rgba(0,150,136,0.15);
}

.table thead th {
  background: #00796b !important;
  color: #fff !important;
}

.table tbody tr:hover {
  background: #e0f7fa;
}

/* ACTION BUTTONS */
.btn-edit {
  background: #0288d1;
  color: white;
  border-radius: 8px;
  padding: 5px 12px;
  border: none;
}
.btn-edit:hover { background: #0277bd; }

.btn-delete {
  background: #d32f2f;
  color: white !important;
  border-radius: 8px;
  padding: 5px 12px;
  border: none;
  text-decoration: none !important;
}
.btn-delete:hover { background: #b71c1c; }

/* MODAL */
.modal-header {
  background: #009688;
  color: white;
}

.modal-content {
  border-radius: 16px;
}

.form-control {
  border-radius: 10px;
  border: 1px solid #b2dfdb;
  background: #f9fffe;
}

.form-control:focus {
  border-color: #009688;
  box-shadow: 0 0 5px rgba(0,150,136,0.3);
}
</style>
</head>

<body>

{% include 'navbar.html' %}

<div class="container-box">

  <h2 class="page-title">üë®‚Äçüè´ Mentor Dashboard</h2>

  <!-- Add Mentor Button -->
  <div class="text-end mb-3">
    <a href="/create-mentor/" class="btn-add">+ Add Mentor</a>
  </div>

  <!-- TABLE -->
  <div class="table-box">
    <table class="table table-bordered text-center align-middle">
      <thead>
        <tr>
          <th>#</th>
          <th>Full Name</th>
          <th>Email</th>
          <th>Username</th>
          <th>Password</th>
          <th>Phone</th>
          <th>Actions</th>
        </tr>
      </thead>

      <tbody>

        {% for m in mentors %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ m.user.first_name }}</td>
          <td>{{ m.user.email }}</td>
          <td>{{ m.username_plain }}</td>
          <td>{{ m.password_plain }}</td>
          <td>{{ m.phone }}</td>

          <td>

            <!-- Edit button with data attributes -->
            <button class="btn-edit"
                    data-bs-toggle="modal"
                    data-bs-target="#editModal"
                    data-id="{{ m.id }}"
                    data-name="{{ m.user.first_name }}"
                    data-email="{{ m.user.email }}"
                    data-phone="{{ m.phone }}">
              Edit
            </button>

            <a href="/delete-mentor/{{ m.id }}/" class="btn-delete ms-2"
               onclick="return confirm('Are you sure you want to delete this mentor?')">
               Delete
            </a>
          </td>
        </tr>
        {% endfor %}

      </tbody>
    </table>
  </div>

</div>


<!-- EDIT MODAL -->
<div class="modal fade" id="editModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Edit Mentor</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <form method="POST" action="/update-mentor/" id="editForm">
        {% csrf_token %}

        <div class="modal-body">

          <input type="hidden" id="edit-id" name="mentor_id">

          <label class="mt-2">Full Name</label>
          <input id="edit-name" name="name" type="text" class="form-control">

          <label class="mt-2">Email</label>
          <input id="edit-email" name="email" type="email" class="form-control">

          <label class="mt-2">Phone Number</label>
          <input id="edit-phone" name="phone" type="text" class="form-control">

        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn-add">Save Changes</button>
        </div>

      </form>

    </div>
  </div>
</div>


<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Auto Fill Edit Modal -->
<script>
const editModal = document.getElementById('editModal');
editModal.addEventListener('show.bs.modal', function (event) {
    let btn = event.relatedTarget;

    document.getElementById("edit-id").value = btn.getAttribute("data-id");
    document.getElementById("edit-name").value = btn.getAttribute("data-name");
    document.getElementById("edit-email").value = btn.getAttribute("data-email");
    document.getElementById("edit-phone").value = btn.getAttribute("data-phone");
});
</script>

</body>
</html>
